{"ast":null,"code":"import _asyncToGenerator from \"/home/hmnd/code/poetryslam/web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { querySelectorRoots as e } from \"../utils/dom.js\";\nimport { onFirstInteraction as t, onChildListMutation as r } from \"../utils/events.js\";\nimport { createId as a } from \"../utils/identity.js\";\nimport { KeyNavigationListController as s } from \"./key-navigation-list.controller.js\";\nlet i = null;\n\nfunction d(e) {\n  return t => t.addInitializer(t => new n(t, e));\n}\n\nclass n {\n  constructor(e, t) {\n    this.host = e, this.id = \"__\" + a(), this.host.addController(this), this.config = {\n      layout: \"both\",\n      item: \"\",\n      dropZone: \"\",\n      manageFocus: !0,\n      manageTabindex: !1,\n      ...t\n    };\n  }\n\n  get items() {\n    return e(this.host, this.config.item + '[draggable=\"true\"]');\n  }\n\n  get dropZones() {\n    return e(this.host, this.config.dropZone + '[draggable=\"false\"]');\n  }\n\n  hostConnected() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.host.updateComplete, t(_this.host).then(() => {\n        _this.addDragEventListeners(_this.items), _this.initializeKeyListController(), _this.host.addEventListener(\"click\", /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (e) {\n            return _this.clickItem(e);\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }()), _this.host.addEventListener(\"cdsKeyChange\", e => _this.focusItem(e)), _this.host.shadowRoot?.addEventListener(\"click\", /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (e) {\n            return _this.clickItem(e);\n          });\n\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }()), _this.host.shadowRoot?.addEventListener(\"cdsKeyChange\", e => _this.focusItem(e)), _this.observer = r(_this.host, e => {\n          if (e) {\n            const t = Array.from(e.addedNodes).filter(e => e.draggable);\n            t.length && _this.addDragEventListeners(t);\n          }\n        });\n      });\n    })();\n  }\n\n  hostDisconnected() {\n    this.observer?.disconnect();\n  }\n\n  initializeKeyListController() {\n    Object.defineProperty(this.host, this.id, {\n      get: () => this.items.map(e => e.querySelector(\"[cds-draggable]\"))\n    }), new s(this.host, {\n      layout: this.config.layout,\n      keyListItems: this.id,\n      manageFocus: this.config.manageFocus,\n      manageTabindex: this.config.manageTabindex\n    });\n  }\n\n  clickItem(e) {\n    const t = Array.from(e.composedPath()).find(e => e.getAttribute && \"handle\" === e.getAttribute(\"cds-draggable\")),\n          r = e.composedPath()[0].closest(\"[draggable]\");\n    t && r && (\"true\" === t.ariaPressed ? (r.setAttribute(\"cds-draggable\", \"active\"), o(e.currentTarget, r, null, \"grabbed\", \"touch\")) : \"false\" === t.ariaPressed && (r.removeAttribute(\"cds-draggable\"), o(e.currentTarget, r, null, \"dropped\", \"touch\")));\n  }\n\n  focusItem(e) {\n    if (e.detail.keyListItems === this.id && \"active\" === e.detail.previousItem?.closest(\"[draggable]\").getAttribute(\"cds-draggable\")) {\n      const t = e.detail.previousItem?.closest(\"[draggable]\"),\n            r = e.detail.activeItem.closest(\"[draggable]\");\n      \"handle\" === e.detail.activeItem.getAttribute(\"cds-draggable\") && t !== r && (e.detail.previousItem.ariaPressed = \"false\", e.detail.activeItem.ariaPressed = \"true\", e.detail.previousItem.pressed = !1, e.detail.activeItem.pressed = !0, t.removeAttribute(\"cds-draggable\"), r.setAttribute(\"cds-draggable\", \"active\"), o(e.detail.activeItem, t, r, \"reordered\", \"key\"));\n    }\n  }\n\n  addDragEventListeners(e) {\n    e.filter(e => !e.cdsDraggableItem).forEach(e => {\n      return (t = e).cdsDraggableItem = \"item\", t.addEventListener(\"dragstart\", g, !1), t.addEventListener(\"dragover\", c, !1), t.addEventListener(\"drop\", l, !1), t.addEventListener(\"dragleave\", u, !1), void t.addEventListener(\"dragend\", e => e.currentTarget.removeAttribute(\"cds-draggable\"), !1);\n      var t;\n    }), this.dropZones.filter(e => !e.cdsDraggableItem).forEach(e => {\n      e.addEventListener(\"dragover\", c, !1), e.addEventListener(\"dragleave\", u, !1), e.addEventListener(\"drop\", l, !1), e.cdsDraggableItem = \"dropzone\";\n    });\n  }\n\n}\n\nfunction o(_x3, _x4, _x5, _x6, _x7) {\n  return _o.apply(this, arguments);\n}\n\nfunction _o() {\n  _o = _asyncToGenerator(function* (e, t, r, a, s) {\n    e?.updateComplete && (yield e.updateComplete), e.dispatchEvent(new CustomEvent(\"cdsDraggableChange\", {\n      detail: {\n        from: t,\n        target: r,\n        type: a,\n        interaction: s\n      },\n      bubbles: !0\n    }));\n  });\n  return _o.apply(this, arguments);\n}\n\nfunction g(e) {\n  i = e.currentTarget, e.dataTransfer.effectAllowed = \"move\", e.dataTransfer.setDragImage(e.currentTarget, 0, 0), e.currentTarget.setAttribute(\"cds-draggable\", \"active\"), o(e.currentTarget, e.currentTarget, null, \"grabbed\", \"touch\");\n}\n\nfunction c(e) {\n  return e.preventDefault && e.preventDefault(), e.dataTransfer.dropEffect = \"move\", i !== e.currentTarget && e.currentTarget.setAttribute(\"cds-draggable\", \"target\"), !1;\n}\n\nfunction l(e) {\n  const t = i,\n        r = e.currentTarget;\n  return t?.removeAttribute(\"cds-draggable\"), r?.removeAttribute(\"cds-draggable\"), o(e.currentTarget, t, r, \"reordered\", \"touch\"), !1;\n}\n\nfunction u(e) {\n  \"target\" === e.currentTarget.getAttribute(\"cds-draggable\") && e.currentTarget.removeAttribute(\"cds-draggable\");\n}\n\nexport { n as DraggableListController, d as draggableList };","map":{"version":3,"sources":["/home/hmnd/code/poetryslam/web-app/node_modules/@cds/core/internal/controllers/draggable-list.controller.js"],"names":["querySelectorRoots","e","onFirstInteraction","t","onChildListMutation","r","createId","a","KeyNavigationListController","s","i","d","addInitializer","n","constructor","host","id","addController","config","layout","item","dropZone","manageFocus","manageTabindex","items","dropZones","hostConnected","updateComplete","then","addDragEventListeners","initializeKeyListController","addEventListener","clickItem","focusItem","shadowRoot","observer","Array","from","addedNodes","filter","draggable","length","hostDisconnected","disconnect","Object","defineProperty","get","map","querySelector","keyListItems","composedPath","find","getAttribute","closest","ariaPressed","setAttribute","o","currentTarget","removeAttribute","detail","previousItem","activeItem","pressed","cdsDraggableItem","forEach","g","c","l","u","dispatchEvent","CustomEvent","target","type","interaction","bubbles","dataTransfer","effectAllowed","setDragImage","preventDefault","dropEffect","DraggableListController","draggableList"],"mappings":";AAAA,SAAOA,kBAAkB,IAAIC,CAA7B,QAAmC,iBAAnC;AAAqD,SAAOC,kBAAkB,IAAIC,CAA7B,EAA+BC,mBAAmB,IAAIC,CAAtD,QAA4D,oBAA5D;AAAiF,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sBAAzB;AAAgD,SAAOC,2BAA2B,IAAIC,CAAtC,QAA4C,qCAA5C;AAAkF,IAAIC,CAAC,GAAC,IAAN;;AAAW,SAASC,CAAT,CAAWV,CAAX,EAAa;AAAC,SAAOE,CAAC,IAAEA,CAAC,CAACS,cAAF,CAAkBT,CAAC,IAAE,IAAIU,CAAJ,CAAMV,CAAN,EAAQF,CAAR,CAArB,CAAV;AAA4C;;AAAA,MAAMY,CAAN,CAAO;AAACC,EAAAA,WAAW,CAACb,CAAD,EAAGE,CAAH,EAAK;AAAC,SAAKY,IAAL,GAAUd,CAAV,EAAY,KAAKe,EAAL,GAAQ,OAAKT,CAAC,EAA1B,EAA6B,KAAKQ,IAAL,CAAUE,aAAV,CAAwB,IAAxB,CAA7B,EAA2D,KAAKC,MAAL,GAAY;AAACC,MAAAA,MAAM,EAAC,MAAR;AAAeC,MAAAA,IAAI,EAAC,EAApB;AAAuBC,MAAAA,QAAQ,EAAC,EAAhC;AAAmCC,MAAAA,WAAW,EAAC,CAAC,CAAhD;AAAkDC,MAAAA,cAAc,EAAC,CAAC,CAAlE;AAAoE,SAAGpB;AAAvE,KAAvE;AAAiJ;;AAAS,MAALqB,KAAK,GAAE;AAAC,WAAOvB,CAAC,CAAC,KAAKc,IAAN,EAAW,KAAKG,MAAL,CAAYE,IAAZ,GAAiB,oBAA5B,CAAR;AAA0D;;AAAa,MAATK,SAAS,GAAE;AAAC,WAAOxB,CAAC,CAAC,KAAKc,IAAN,EAAW,KAAKG,MAAL,CAAYG,QAAZ,GAAqB,qBAAhC,CAAR;AAA+D;;AAAMK,EAAAA,aAAa,GAAE;AAAA;;AAAA;AAAC,YAAM,KAAI,CAACX,IAAL,CAAUY,cAAhB,EAA+BxB,CAAC,CAAC,KAAI,CAACY,IAAN,CAAD,CAAaa,IAAb,CAAmB,MAAI;AAAC,QAAA,KAAI,CAACC,qBAAL,CAA2B,KAAI,CAACL,KAAhC,GAAuC,KAAI,CAACM,2BAAL,EAAvC,EAA0E,KAAI,CAACf,IAAL,CAAUgB,gBAAV,CAA2B,OAA3B;AAAA,uCAAoC,WAAM9B,CAAN;AAAA,mBAAS,KAAI,CAAC+B,SAAL,CAAe/B,CAAf,CAAT;AAAA,WAApC;;AAAA;AAAA;AAAA;AAAA,YAA1E,EAA2I,KAAI,CAACc,IAAL,CAAUgB,gBAAV,CAA2B,cAA3B,EAA2C9B,CAAC,IAAE,KAAI,CAACgC,SAAL,CAAehC,CAAf,CAA9C,CAA3I,EAA6M,KAAI,CAACc,IAAL,CAAUmB,UAAV,EAAsBH,gBAAtB,CAAuC,OAAvC;AAAA,wCAAgD,WAAM9B,CAAN;AAAA,mBAAS,KAAI,CAAC+B,SAAL,CAAe/B,CAAf,CAAT;AAAA,WAAhD;;AAAA;AAAA;AAAA;AAAA,YAA7M,EAA0R,KAAI,CAACc,IAAL,CAAUmB,UAAV,EAAsBH,gBAAtB,CAAuC,cAAvC,EAAuD9B,CAAC,IAAE,KAAI,CAACgC,SAAL,CAAehC,CAAf,CAA1D,CAA1R,EAAwW,KAAI,CAACkC,QAAL,GAAc9B,CAAC,CAAC,KAAI,CAACU,IAAN,EAAYd,CAAC,IAAE;AAAC,cAAGA,CAAH,EAAK;AAAC,kBAAME,CAAC,GAACiC,KAAK,CAACC,IAAN,CAAWpC,CAAC,CAACqC,UAAb,EAAyBC,MAAzB,CAAiCtC,CAAC,IAAEA,CAAC,CAACuC,SAAtC,CAAR;AAA0DrC,YAAAA,CAAC,CAACsC,MAAF,IAAU,KAAI,CAACZ,qBAAL,CAA2B1B,CAA3B,CAAV;AAAwC;AAAC,SAAzH,CAAvX;AAAmf,OAA3gB,CAA/B;AAAD;AAA8iB;;AAAAuC,EAAAA,gBAAgB,GAAE;AAAC,SAAKP,QAAL,EAAeQ,UAAf;AAA4B;;AAAAb,EAAAA,2BAA2B,GAAE;AAACc,IAAAA,MAAM,CAACC,cAAP,CAAsB,KAAK9B,IAA3B,EAAgC,KAAKC,EAArC,EAAwC;AAAC8B,MAAAA,GAAG,EAAC,MAAI,KAAKtB,KAAL,CAAWuB,GAAX,CAAgB9C,CAAC,IAAEA,CAAC,CAAC+C,aAAF,CAAgB,iBAAhB,CAAnB;AAAT,KAAxC,GAA2G,IAAIvC,CAAJ,CAAM,KAAKM,IAAX,EAAgB;AAACI,MAAAA,MAAM,EAAC,KAAKD,MAAL,CAAYC,MAApB;AAA2B8B,MAAAA,YAAY,EAAC,KAAKjC,EAA7C;AAAgDM,MAAAA,WAAW,EAAC,KAAKJ,MAAL,CAAYI,WAAxE;AAAoFC,MAAAA,cAAc,EAAC,KAAKL,MAAL,CAAYK;AAA/G,KAAhB,CAA3G;AAA2P;;AAAAS,EAAAA,SAAS,CAAC/B,CAAD,EAAG;AAAC,UAAME,CAAC,GAACiC,KAAK,CAACC,IAAN,CAAWpC,CAAC,CAACiD,YAAF,EAAX,EAA6BC,IAA7B,CAAmClD,CAAC,IAAEA,CAAC,CAACmD,YAAF,IAAgB,aAAWnD,CAAC,CAACmD,YAAF,CAAe,eAAf,CAAjE,CAAR;AAAA,UAA2G/C,CAAC,GAACJ,CAAC,CAACiD,YAAF,GAAiB,CAAjB,EAAoBG,OAApB,CAA4B,aAA5B,CAA7G;AAAwJlD,IAAAA,CAAC,IAAEE,CAAH,KAAO,WAASF,CAAC,CAACmD,WAAX,IAAwBjD,CAAC,CAACkD,YAAF,CAAe,eAAf,EAA+B,QAA/B,GAAyCC,CAAC,CAACvD,CAAC,CAACwD,aAAH,EAAiBpD,CAAjB,EAAmB,IAAnB,EAAwB,SAAxB,EAAkC,OAAlC,CAAlE,IAA8G,YAAUF,CAAC,CAACmD,WAAZ,KAA0BjD,CAAC,CAACqD,eAAF,CAAkB,eAAlB,GAAmCF,CAAC,CAACvD,CAAC,CAACwD,aAAH,EAAiBpD,CAAjB,EAAmB,IAAnB,EAAwB,SAAxB,EAAkC,OAAlC,CAA9D,CAArH;AAAgO;;AAAA4B,EAAAA,SAAS,CAAChC,CAAD,EAAG;AAAC,QAAGA,CAAC,CAAC0D,MAAF,CAASV,YAAT,KAAwB,KAAKjC,EAA7B,IAAiC,aAAWf,CAAC,CAAC0D,MAAF,CAASC,YAAT,EAAuBP,OAAvB,CAA+B,aAA/B,EAA8CD,YAA9C,CAA2D,eAA3D,CAA/C,EAA2H;AAAC,YAAMjD,CAAC,GAACF,CAAC,CAAC0D,MAAF,CAASC,YAAT,EAAuBP,OAAvB,CAA+B,aAA/B,CAAR;AAAA,YAAsDhD,CAAC,GAACJ,CAAC,CAAC0D,MAAF,CAASE,UAAT,CAAoBR,OAApB,CAA4B,aAA5B,CAAxD;AAAmG,mBAAWpD,CAAC,CAAC0D,MAAF,CAASE,UAAT,CAAoBT,YAApB,CAAiC,eAAjC,CAAX,IAA8DjD,CAAC,KAAGE,CAAlE,KAAsEJ,CAAC,CAAC0D,MAAF,CAASC,YAAT,CAAsBN,WAAtB,GAAkC,OAAlC,EAA0CrD,CAAC,CAAC0D,MAAF,CAASE,UAAT,CAAoBP,WAApB,GAAgC,MAA1E,EAAiFrD,CAAC,CAAC0D,MAAF,CAASC,YAAT,CAAsBE,OAAtB,GAA8B,CAAC,CAAhH,EAAkH7D,CAAC,CAAC0D,MAAF,CAASE,UAAT,CAAoBC,OAApB,GAA4B,CAAC,CAA/I,EAAiJ3D,CAAC,CAACuD,eAAF,CAAkB,eAAlB,CAAjJ,EAAoLrD,CAAC,CAACkD,YAAF,CAAe,eAAf,EAA+B,QAA/B,CAApL,EAA6NC,CAAC,CAACvD,CAAC,CAAC0D,MAAF,CAASE,UAAV,EAAqB1D,CAArB,EAAuBE,CAAvB,EAAyB,WAAzB,EAAqC,KAArC,CAApS;AAAiV;AAAC;;AAAAwB,EAAAA,qBAAqB,CAAC5B,CAAD,EAAG;AAACA,IAAAA,CAAC,CAACsC,MAAF,CAAUtC,CAAC,IAAE,CAACA,CAAC,CAAC8D,gBAAhB,EAAmCC,OAAnC,CAA4C/D,CAAC,IAAE;AAAC,aAAM,CAACE,CAAC,GAACF,CAAH,EAAM8D,gBAAN,GAAuB,MAAvB,EAA8B5D,CAAC,CAAC4B,gBAAF,CAAmB,WAAnB,EAA+BkC,CAA/B,EAAiC,CAAC,CAAlC,CAA9B,EAAmE9D,CAAC,CAAC4B,gBAAF,CAAmB,UAAnB,EAA8BmC,CAA9B,EAAgC,CAAC,CAAjC,CAAnE,EAAuG/D,CAAC,CAAC4B,gBAAF,CAAmB,MAAnB,EAA0BoC,CAA1B,EAA4B,CAAC,CAA7B,CAAvG,EAAuIhE,CAAC,CAAC4B,gBAAF,CAAmB,WAAnB,EAA+BqC,CAA/B,EAAiC,CAAC,CAAlC,CAAvI,EAA4K,KAAKjE,CAAC,CAAC4B,gBAAF,CAAmB,SAAnB,EAA8B9B,CAAC,IAAEA,CAAC,CAACwD,aAAF,CAAgBC,eAAhB,CAAgC,eAAhC,CAAjC,EAAmF,CAAC,CAApF,CAAvL;AAA8Q,UAAIvD,CAAJ;AAAM,KAApU,GAAuU,KAAKsB,SAAL,CAAec,MAAf,CAAuBtC,CAAC,IAAE,CAACA,CAAC,CAAC8D,gBAA7B,EAAgDC,OAAhD,CAAyD/D,CAAC,IAAE;AAACA,MAAAA,CAAC,CAAC8B,gBAAF,CAAmB,UAAnB,EAA8BmC,CAA9B,EAAgC,CAAC,CAAjC,GAAoCjE,CAAC,CAAC8B,gBAAF,CAAmB,WAAnB,EAA+BqC,CAA/B,EAAiC,CAAC,CAAlC,CAApC,EAAyEnE,CAAC,CAAC8B,gBAAF,CAAmB,MAAnB,EAA0BoC,CAA1B,EAA4B,CAAC,CAA7B,CAAzE,EAAyGlE,CAAC,CAAC8D,gBAAF,GAAmB,UAA5H;AAAuI,KAApM,CAAvU;AAA8gB;;AAA7qF;;SAA6rFP,C;;;;;yBAAf,WAAiBvD,CAAjB,EAAmBE,CAAnB,EAAqBE,CAArB,EAAuBE,CAAvB,EAAyBE,CAAzB,EAA2B;AAACR,IAAAA,CAAC,EAAE0B,cAAH,WAAyB1B,CAAC,CAAC0B,cAA3B,GAA0C1B,CAAC,CAACoE,aAAF,CAAgB,IAAIC,WAAJ,CAAgB,oBAAhB,EAAqC;AAACX,MAAAA,MAAM,EAAC;AAACtB,QAAAA,IAAI,EAAClC,CAAN;AAAQoE,QAAAA,MAAM,EAAClE,CAAf;AAAiBmE,QAAAA,IAAI,EAACjE,CAAtB;AAAwBkE,QAAAA,WAAW,EAAChE;AAApC,OAAR;AAA+CiE,MAAAA,OAAO,EAAC,CAAC;AAAxD,KAArC,CAAhB,CAA1C;AAA4J,G;;;;AAAA,SAAST,CAAT,CAAWhE,CAAX,EAAa;AAACS,EAAAA,CAAC,GAACT,CAAC,CAACwD,aAAJ,EAAkBxD,CAAC,CAAC0E,YAAF,CAAeC,aAAf,GAA6B,MAA/C,EAAsD3E,CAAC,CAAC0E,YAAF,CAAeE,YAAf,CAA4B5E,CAAC,CAACwD,aAA9B,EAA4C,CAA5C,EAA8C,CAA9C,CAAtD,EAAuGxD,CAAC,CAACwD,aAAF,CAAgBF,YAAhB,CAA6B,eAA7B,EAA6C,QAA7C,CAAvG,EAA8JC,CAAC,CAACvD,CAAC,CAACwD,aAAH,EAAiBxD,CAAC,CAACwD,aAAnB,EAAiC,IAAjC,EAAsC,SAAtC,EAAgD,OAAhD,CAA/J;AAAwN;;AAAA,SAASS,CAAT,CAAWjE,CAAX,EAAa;AAAC,SAAOA,CAAC,CAAC6E,cAAF,IAAkB7E,CAAC,CAAC6E,cAAF,EAAlB,EAAqC7E,CAAC,CAAC0E,YAAF,CAAeI,UAAf,GAA0B,MAA/D,EAAsErE,CAAC,KAAGT,CAAC,CAACwD,aAAN,IAAqBxD,CAAC,CAACwD,aAAF,CAAgBF,YAAhB,CAA6B,eAA7B,EAA6C,QAA7C,CAA3F,EAAkJ,CAAC,CAA1J;AAA4J;;AAAA,SAASY,CAAT,CAAWlE,CAAX,EAAa;AAAC,QAAME,CAAC,GAACO,CAAR;AAAA,QAAUL,CAAC,GAACJ,CAAC,CAACwD,aAAd;AAA4B,SAAOtD,CAAC,EAAEuD,eAAH,CAAmB,eAAnB,GAAoCrD,CAAC,EAAEqD,eAAH,CAAmB,eAAnB,CAApC,EAAwEF,CAAC,CAACvD,CAAC,CAACwD,aAAH,EAAiBtD,CAAjB,EAAmBE,CAAnB,EAAqB,WAArB,EAAiC,OAAjC,CAAzE,EAAmH,CAAC,CAA3H;AAA6H;;AAAA,SAAS+D,CAAT,CAAWnE,CAAX,EAAa;AAAC,eAAWA,CAAC,CAACwD,aAAF,CAAgBL,YAAhB,CAA6B,eAA7B,CAAX,IAA0DnD,CAAC,CAACwD,aAAF,CAAgBC,eAAhB,CAAgC,eAAhC,CAA1D;AAA2G;;AAAA,SAAO7C,CAAC,IAAImE,uBAAZ,EAAoCrE,CAAC,IAAIsE,aAAzC","sourcesContent":["import{querySelectorRoots as e}from\"../utils/dom.js\";import{onFirstInteraction as t,onChildListMutation as r}from\"../utils/events.js\";import{createId as a}from\"../utils/identity.js\";import{KeyNavigationListController as s}from\"./key-navigation-list.controller.js\";let i=null;function d(e){return t=>t.addInitializer((t=>new n(t,e)))}class n{constructor(e,t){this.host=e,this.id=\"__\"+a(),this.host.addController(this),this.config={layout:\"both\",item:\"\",dropZone:\"\",manageFocus:!0,manageTabindex:!1,...t}}get items(){return e(this.host,this.config.item+'[draggable=\"true\"]')}get dropZones(){return e(this.host,this.config.dropZone+'[draggable=\"false\"]')}async hostConnected(){await this.host.updateComplete,t(this.host).then((()=>{this.addDragEventListeners(this.items),this.initializeKeyListController(),this.host.addEventListener(\"click\",(async e=>this.clickItem(e))),this.host.addEventListener(\"cdsKeyChange\",(e=>this.focusItem(e))),this.host.shadowRoot?.addEventListener(\"click\",(async e=>this.clickItem(e))),this.host.shadowRoot?.addEventListener(\"cdsKeyChange\",(e=>this.focusItem(e))),this.observer=r(this.host,(e=>{if(e){const t=Array.from(e.addedNodes).filter((e=>e.draggable));t.length&&this.addDragEventListeners(t)}}))}))}hostDisconnected(){this.observer?.disconnect()}initializeKeyListController(){Object.defineProperty(this.host,this.id,{get:()=>this.items.map((e=>e.querySelector(\"[cds-draggable]\")))}),new s(this.host,{layout:this.config.layout,keyListItems:this.id,manageFocus:this.config.manageFocus,manageTabindex:this.config.manageTabindex})}clickItem(e){const t=Array.from(e.composedPath()).find((e=>e.getAttribute&&\"handle\"===e.getAttribute(\"cds-draggable\"))),r=e.composedPath()[0].closest(\"[draggable]\");t&&r&&(\"true\"===t.ariaPressed?(r.setAttribute(\"cds-draggable\",\"active\"),o(e.currentTarget,r,null,\"grabbed\",\"touch\")):\"false\"===t.ariaPressed&&(r.removeAttribute(\"cds-draggable\"),o(e.currentTarget,r,null,\"dropped\",\"touch\")))}focusItem(e){if(e.detail.keyListItems===this.id&&\"active\"===e.detail.previousItem?.closest(\"[draggable]\").getAttribute(\"cds-draggable\")){const t=e.detail.previousItem?.closest(\"[draggable]\"),r=e.detail.activeItem.closest(\"[draggable]\");\"handle\"===e.detail.activeItem.getAttribute(\"cds-draggable\")&&t!==r&&(e.detail.previousItem.ariaPressed=\"false\",e.detail.activeItem.ariaPressed=\"true\",e.detail.previousItem.pressed=!1,e.detail.activeItem.pressed=!0,t.removeAttribute(\"cds-draggable\"),r.setAttribute(\"cds-draggable\",\"active\"),o(e.detail.activeItem,t,r,\"reordered\",\"key\"))}}addDragEventListeners(e){e.filter((e=>!e.cdsDraggableItem)).forEach((e=>{return(t=e).cdsDraggableItem=\"item\",t.addEventListener(\"dragstart\",g,!1),t.addEventListener(\"dragover\",c,!1),t.addEventListener(\"drop\",l,!1),t.addEventListener(\"dragleave\",u,!1),void t.addEventListener(\"dragend\",(e=>e.currentTarget.removeAttribute(\"cds-draggable\")),!1);var t})),this.dropZones.filter((e=>!e.cdsDraggableItem)).forEach((e=>{e.addEventListener(\"dragover\",c,!1),e.addEventListener(\"dragleave\",u,!1),e.addEventListener(\"drop\",l,!1),e.cdsDraggableItem=\"dropzone\"}))}}async function o(e,t,r,a,s){e?.updateComplete&&await e.updateComplete,e.dispatchEvent(new CustomEvent(\"cdsDraggableChange\",{detail:{from:t,target:r,type:a,interaction:s},bubbles:!0}))}function g(e){i=e.currentTarget,e.dataTransfer.effectAllowed=\"move\",e.dataTransfer.setDragImage(e.currentTarget,0,0),e.currentTarget.setAttribute(\"cds-draggable\",\"active\"),o(e.currentTarget,e.currentTarget,null,\"grabbed\",\"touch\")}function c(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect=\"move\",i!==e.currentTarget&&e.currentTarget.setAttribute(\"cds-draggable\",\"target\"),!1}function l(e){const t=i,r=e.currentTarget;return t?.removeAttribute(\"cds-draggable\"),r?.removeAttribute(\"cds-draggable\"),o(e.currentTarget,t,r,\"reordered\",\"touch\"),!1}function u(e){\"target\"===e.currentTarget.getAttribute(\"cds-draggable\")&&e.currentTarget.removeAttribute(\"cds-draggable\")}export{n as DraggableListController,d as draggableList};\n"]},"metadata":{},"sourceType":"module"}