{"ast":null,"code":"import _asyncToGenerator from \"/home/hmnd/code/poetryslam/web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { isSafari as o, isWindows as i } from \"../utils/browser.js\";\nimport { onChildListMutation as t } from \"../utils/events.js\";\nimport { getFlattenedFocusableItems as r } from \"../utils/traversal.js\";\n\nfunction e(o = {\n  update: \"slot\"\n}) {\n  return i => {\n    i.addInitializer(i => {\n      i.ariaGridController || (i.ariaGridController = new s(i, o));\n    });\n  };\n}\n\nclass s {\n  constructor(o, i = {\n    update: \"slot\"\n  }) {\n    this.host = o, this.config = i, this.observers = [], o.addController(this);\n  }\n\n  hostConnected() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.host.updateComplete, _this.intializeColumnSort(), _this.update(), \"slot\" === _this.config.update ? _this.host.shadowRoot.addEventListener(\"slotchange\", () => _this.host.updateComplete.then(() => _this.update())) : _this.observers.push(t(_this.host, () => _this.host.updateComplete.then(() => _this.update())));\n    })();\n  }\n\n  hostDisconnected() {\n    this.observers.forEach(o => o?.disconnect());\n  }\n\n  update() {\n    this.grid = {\n      grid: this.host.grid ? this.host.grid : this.host,\n      columnRowGroup: this.host.columnRowGroup,\n      columnRow: this.host.columnRow,\n      columns: this.host.columns,\n      rowGroup: this.host.rowGroup,\n      rows: this.host.rows,\n      cells: this.host.cells,\n      footerRowGroup: this.host.footerRowGroup,\n      footerRow: this.host.footerRow,\n      footerCells: this.host.footerCells,\n      placeholderCell: this.host.placeholderCell\n    }, this.initializeGrid(), this.intializeColumns(), this.initializeRows(), this.initializeCells(), this.initializePlaceholder(), this.intializeFooter();\n  }\n\n  intializeColumnSort() {\n    this.host.addEventListener(\"sortChange\", o => {\n      const i = o.composedPath().find(o => \"columnheader\" === o.role);\n      i && (i.ariaSort = o.detail);\n    });\n  }\n\n  initializeGrid() {\n    const o = Math.max(this.grid.rows?.length, 1),\n          i = this.grid.footerRow ? 1 : 0;\n    this.grid.grid.role = \"grid\", this.grid.grid.ariaRowCount = \"\" + (1 + o + i), this.grid.grid.ariaColCount = \"\" + this.grid.columns.length;\n  }\n\n  intializeColumns() {\n    this.grid.columnRowGroup.role = \"rowgroup\", this.grid.columnRow.role = \"row\", this.grid.columnRow.ariaRowIndex = \"1\", this.grid.columns.forEach((o, i) => {\n      o.role = \"columnheader\", o.ariaColIndex = \"\" + (i + 1), o.ariaSort = \"none\", this.patchInvalidScreenReaderBehavior(o);\n    });\n  }\n\n  initializeRows() {\n    this.grid.rows?.forEach((o, i) => {\n      o.role = \"row\", o.ariaRowIndex = \"\" + (i + 2);\n    });\n  }\n\n  initializeCells() {\n    const o = this.grid.columns.length;\n    this.grid.cells?.forEach((i, t) => {\n      i.role || (i.role = \"gridcell\"), i.ariaColIndex = \"\" + (t % o + 1);\n    });\n  }\n\n  initializePlaceholder() {\n    this.grid.placeholderCell && (this.grid.placeholderCell.ariaColSpan = this.grid.grid.ariaColCount);\n  }\n\n  intializeFooter() {\n    this.grid.footerRowGroup && this.grid.footerRow && (this.grid.footerRowGroup.role = \"rowgroup\", this.grid.footerRow.role = \"row\", this.grid.footerRow.ariaRowIndex = \"\" + (this.grid.rows.length + 2), this.grid.footerCells?.forEach(o => o.role = \"gridcell\"), 1 === this.grid.footerCells?.length && (this.grid.footerCells[0].ariaColSpan = this.grid.grid.ariaColCount));\n  }\n\n  patchInvalidScreenReaderBehavior(t) {\n    if (o() || i()) {\n      const o = r(t).filter(o => !o.readonly),\n            i = t.ariaLabel ? t.ariaLabel : t?.textContent?.trim();\n      (o.length || t.resizable) && i.length && (t.ariaLabel = i, t.setAttribute(\"scope\", \"col\"));\n    }\n  }\n\n}\n\nexport { s as AriaGridController, e as ariaGrid };","map":{"version":3,"sources":["/home/hmnd/code/poetryslam/web-app/node_modules/@cds/core/internal/controllers/aria-grid.controller.js"],"names":["isSafari","o","isWindows","i","onChildListMutation","t","getFlattenedFocusableItems","r","e","update","addInitializer","ariaGridController","s","constructor","host","config","observers","addController","hostConnected","updateComplete","intializeColumnSort","shadowRoot","addEventListener","then","push","hostDisconnected","forEach","disconnect","grid","columnRowGroup","columnRow","columns","rowGroup","rows","cells","footerRowGroup","footerRow","footerCells","placeholderCell","initializeGrid","intializeColumns","initializeRows","initializeCells","initializePlaceholder","intializeFooter","composedPath","find","role","ariaSort","detail","Math","max","length","ariaRowCount","ariaColCount","ariaRowIndex","ariaColIndex","patchInvalidScreenReaderBehavior","ariaColSpan","filter","readonly","ariaLabel","textContent","trim","resizable","setAttribute","AriaGridController","ariaGrid"],"mappings":"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","sourcesContent":["import{isSafari as o,isWindows as i}from\"../utils/browser.js\";import{onChildListMutation as t}from\"../utils/events.js\";import{getFlattenedFocusableItems as r}from\"../utils/traversal.js\";function e(o={update:\"slot\"}){return i=>{i.addInitializer((i=>{i.ariaGridController||(i.ariaGridController=new s(i,o))}))}}class s{constructor(o,i={update:\"slot\"}){this.host=o,this.config=i,this.observers=[],o.addController(this)}async hostConnected(){await this.host.updateComplete,this.intializeColumnSort(),this.update(),\"slot\"===this.config.update?this.host.shadowRoot.addEventListener(\"slotchange\",(()=>this.host.updateComplete.then((()=>this.update())))):this.observers.push(t(this.host,(()=>this.host.updateComplete.then((()=>this.update())))))}hostDisconnected(){this.observers.forEach((o=>o?.disconnect()))}update(){this.grid={grid:this.host.grid?this.host.grid:this.host,columnRowGroup:this.host.columnRowGroup,columnRow:this.host.columnRow,columns:this.host.columns,rowGroup:this.host.rowGroup,rows:this.host.rows,cells:this.host.cells,footerRowGroup:this.host.footerRowGroup,footerRow:this.host.footerRow,footerCells:this.host.footerCells,placeholderCell:this.host.placeholderCell},this.initializeGrid(),this.intializeColumns(),this.initializeRows(),this.initializeCells(),this.initializePlaceholder(),this.intializeFooter()}intializeColumnSort(){this.host.addEventListener(\"sortChange\",(o=>{const i=o.composedPath().find((o=>\"columnheader\"===o.role));i&&(i.ariaSort=o.detail)}))}initializeGrid(){const o=Math.max(this.grid.rows?.length,1),i=this.grid.footerRow?1:0;this.grid.grid.role=\"grid\",this.grid.grid.ariaRowCount=\"\"+(1+o+i),this.grid.grid.ariaColCount=\"\"+this.grid.columns.length}intializeColumns(){this.grid.columnRowGroup.role=\"rowgroup\",this.grid.columnRow.role=\"row\",this.grid.columnRow.ariaRowIndex=\"1\",this.grid.columns.forEach(((o,i)=>{o.role=\"columnheader\",o.ariaColIndex=\"\"+(i+1),o.ariaSort=\"none\",this.patchInvalidScreenReaderBehavior(o)}))}initializeRows(){this.grid.rows?.forEach(((o,i)=>{o.role=\"row\",o.ariaRowIndex=\"\"+(i+2)}))}initializeCells(){const o=this.grid.columns.length;this.grid.cells?.forEach(((i,t)=>{i.role||(i.role=\"gridcell\"),i.ariaColIndex=\"\"+(t%o+1)}))}initializePlaceholder(){this.grid.placeholderCell&&(this.grid.placeholderCell.ariaColSpan=this.grid.grid.ariaColCount)}intializeFooter(){this.grid.footerRowGroup&&this.grid.footerRow&&(this.grid.footerRowGroup.role=\"rowgroup\",this.grid.footerRow.role=\"row\",this.grid.footerRow.ariaRowIndex=\"\"+(this.grid.rows.length+2),this.grid.footerCells?.forEach((o=>o.role=\"gridcell\")),1===this.grid.footerCells?.length&&(this.grid.footerCells[0].ariaColSpan=this.grid.grid.ariaColCount))}patchInvalidScreenReaderBehavior(t){if(o()||i()){const o=r(t).filter((o=>!o.readonly)),i=t.ariaLabel?t.ariaLabel:t?.textContent?.trim();(o.length||t.resizable)&&i.length&&(t.ariaLabel=i,t.setAttribute(\"scope\",\"col\"))}}}export{s as AriaGridController,e as ariaGrid};\n"]},"metadata":{},"sourceType":"module"}