{"ast":null,"code":"import _asyncToGenerator from \"/home/hmnd/code/poetryslam/web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nfunction t() {\n  return t => t.addInitializer(t => new e(t));\n}\n\nclass e {\n  constructor(t) {\n    this.host = t, this.selectionActive = !1, t.addController(this);\n  }\n\n  get enabled() {\n    return !1 !== this.host.rangeSelection && !Array.from(this.host.rows).find(t => t.draggable);\n  }\n\n  hostConnected() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.host.updateComplete, _this.setupKeyboardListeners(), _this.setupMouseEvents();\n    })();\n  }\n\n  setupMouseEvents() {\n    const t = this.host.grid.shadowRoot ? this.host.grid.shadowRoot : this.host.grid;\n    t.addEventListener(\"mousedown\", t => {\n      this.enabled && 1 === t.buttons && !t.ctrlKey && this.setFirstCell(t);\n    }), t.addEventListener(\"mouseover\", t => {\n      this.enabled && this.setActiveCell(t.composedPath().find(t => Array.from(this.host.cells).includes(t)));\n    }), t.addEventListener(\"mouseup\", () => {\n      this.enabled && this.stopSelection();\n    });\n  }\n\n  setupKeyboardListeners() {\n    this.host.addEventListener(\"cdsKeyChange\", t => {\n      this.enabled && t.detail.code && (this.setActiveCell(t.detail.activeItem), t.detail.shiftKey || (this.stopSelection(), this.resetAllActiveCells(), this.host.dispatchEvent(new CustomEvent(\"rangeSelectionChange\", {\n        detail: []\n      }))));\n    }), this.host.addEventListener(\"keydown\", t => {\n      this.enabled && \"ShiftLeft\" === t.code && t.shiftKey && !this.selectionActive && this.setFirstCell(t);\n    });\n  }\n\n  setFirstCell(t) {\n    const e = t.composedPath().find(t => Array.from(this.host.cells).includes(t));\n    e && (this.firstCell = e, this.selectionActive = !0, this.resetAllActiveCells());\n  }\n\n  setActiveCell(t) {\n    t && this.selectionActive && (this.activeCell = t, this.calculateSelection());\n  }\n\n  stopSelection() {\n    this.selectionActive = !1;\n  }\n\n  resetAllActiveCells() {\n    this.host.cells.forEach(t => t.removeAttribute(\"highlight\"));\n  }\n\n  calculateSelection() {\n    const t = parseInt(this.firstCell.ariaColIndex),\n          e = parseInt(this.activeCell.ariaColIndex),\n          s = parseInt(this.firstCell.parentElement?.ariaRowIndex),\n          i = parseInt(this.activeCell.parentElement?.ariaRowIndex);\n    this.resetAllActiveCells(), this.host.cells.forEach(l => {\n      const h = parseInt(l.ariaColIndex),\n            n = parseInt(l.parentElement?.ariaRowIndex);\n      (t <= e && h >= t && h <= e || t >= e && h <= t && h >= e) && (s <= i && n >= s && n <= i || s >= i && n <= s && n >= i) && l.setAttribute(\"highlight\", \"\");\n    }), this.host.dispatchEvent(new CustomEvent(\"rangeSelectionChange\", {\n      detail: Array.from(this.host.cells).filter(t => t.hasAttribute(\"highlight\"))\n    }));\n  }\n\n}\n\nexport { e as GridRangeSelectionController, t as gridRangeSelection };","map":{"version":3,"sources":["/home/hmnd/code/poetryslam/web-app/node_modules/@cds/core/internal/controllers/grid-range-selection.controller.js"],"names":["t","addInitializer","e","constructor","host","selectionActive","addController","enabled","rangeSelection","Array","from","rows","find","draggable","hostConnected","updateComplete","setupKeyboardListeners","setupMouseEvents","grid","shadowRoot","addEventListener","buttons","ctrlKey","setFirstCell","setActiveCell","composedPath","cells","includes","stopSelection","detail","code","activeItem","shiftKey","resetAllActiveCells","dispatchEvent","CustomEvent","firstCell","activeCell","calculateSelection","forEach","removeAttribute","parseInt","ariaColIndex","s","parentElement","ariaRowIndex","i","l","h","n","setAttribute","filter","hasAttribute","GridRangeSelectionController","gridRangeSelection"],"mappings":"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","sourcesContent":["function t(){return t=>t.addInitializer((t=>new e(t)))}class e{constructor(t){this.host=t,this.selectionActive=!1,t.addController(this)}get enabled(){return!1!==this.host.rangeSelection&&!Array.from(this.host.rows).find((t=>t.draggable))}async hostConnected(){await this.host.updateComplete,this.setupKeyboardListeners(),this.setupMouseEvents()}setupMouseEvents(){const t=this.host.grid.shadowRoot?this.host.grid.shadowRoot:this.host.grid;t.addEventListener(\"mousedown\",(t=>{this.enabled&&1===t.buttons&&!t.ctrlKey&&this.setFirstCell(t)})),t.addEventListener(\"mouseover\",(t=>{this.enabled&&this.setActiveCell(t.composedPath().find((t=>Array.from(this.host.cells).includes(t))))})),t.addEventListener(\"mouseup\",(()=>{this.enabled&&this.stopSelection()}))}setupKeyboardListeners(){this.host.addEventListener(\"cdsKeyChange\",(t=>{this.enabled&&t.detail.code&&(this.setActiveCell(t.detail.activeItem),t.detail.shiftKey||(this.stopSelection(),this.resetAllActiveCells(),this.host.dispatchEvent(new CustomEvent(\"rangeSelectionChange\",{detail:[]}))))})),this.host.addEventListener(\"keydown\",(t=>{this.enabled&&\"ShiftLeft\"===t.code&&t.shiftKey&&!this.selectionActive&&this.setFirstCell(t)}))}setFirstCell(t){const e=t.composedPath().find((t=>Array.from(this.host.cells).includes(t)));e&&(this.firstCell=e,this.selectionActive=!0,this.resetAllActiveCells())}setActiveCell(t){t&&this.selectionActive&&(this.activeCell=t,this.calculateSelection())}stopSelection(){this.selectionActive=!1}resetAllActiveCells(){this.host.cells.forEach((t=>t.removeAttribute(\"highlight\")))}calculateSelection(){const t=parseInt(this.firstCell.ariaColIndex),e=parseInt(this.activeCell.ariaColIndex),s=parseInt(this.firstCell.parentElement?.ariaRowIndex),i=parseInt(this.activeCell.parentElement?.ariaRowIndex);this.resetAllActiveCells(),this.host.cells.forEach((l=>{const h=parseInt(l.ariaColIndex),n=parseInt(l.parentElement?.ariaRowIndex);(t<=e&&h>=t&&h<=e||t>=e&&h<=t&&h>=e)&&(s<=i&&n>=s&&n<=i||s>=i&&n<=s&&n>=i)&&l.setAttribute(\"highlight\",\"\")})),this.host.dispatchEvent(new CustomEvent(\"rangeSelectionChange\",{detail:Array.from(this.host.cells).filter((t=>t.hasAttribute(\"highlight\")))}))}}export{e as GridRangeSelectionController,t as gridRangeSelection};\n"]},"metadata":{},"sourceType":"module"}